{% extends "base.html" %}
{% block title %}My Adverts{% endblock %}
{% block content %}
<h2 class="mb-3">ğŸ“‹ My Adverts</h2>

<table class="table table-striped align-middle">
    <thead>
    <tr>
        <th>Image</th>
        <th>Title</th>
        <th>Price</th>
        <th>Category</th>
        <th>Status</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    {% for advert in adverts %}
    <tr>
        <!-- Small image preview -->
        <td>
            {% if advert.image %}
            <img src="{{ advert.image.url }}" class="card-img-top" alt="{{ advert.title }}" class="img-thumbnail"
                 style="width:60px; height:60px; object-fit:cover;">
            {% else %}
            <span class="text-muted">No image</span>
            {% endif %}
        </td>

        <td>{{ advert.title }}</td>
        <td>KSh {{ advert.price }}</td>
        <td>{{ advert.category.name }}</td>

        <!-- Draft / Active toggle -->
        <td>
            {% if advert.active %}
            <span class="badge bg-success">Active</span>
            {% else %}
            <span class="badge bg-secondary">Draft</span>
            {% endif %}
        </td>

        <!-- Actions -->
        <td>
            <a href="{% url 'product_detail' advert.pk %}" class="btn btn-sm btn-outline-info">ğŸ‘ View</a>
            <a href="{% url 'edit_advert' advert.pk %}" class="btn btn-sm btn-outline-primary">âœ Edit</a>
            {% if advert.active %}
            <a href="{% url 'toggle_advert_status' advert.pk %}" class="btn btn-sm btn-warning">ğŸ“¥ Draft</a>
            {% else %}
            <a href="{% url 'toggle_advert_status' advert.pk %}" class="btn btn-sm btn-success">ğŸš€ Activate</a>
            {% endif %}

            <!-- New delete button -->
            <form method="post" action="{% url 'delete_advert' advert.pk %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-outline-danger"
                        onclick="return confirm('Are you sure you want to delete this advert?');">
                    ğŸ—‘ Delete
                </button>
            </form>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
